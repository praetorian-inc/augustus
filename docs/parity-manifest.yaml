# Parity Manifest - Tracks garak â†’ Augustus port progress
#
# Status values:
#   pending  - Not yet ported
#   ported   - Code written, not tested
#   tested   - Unit tests passing
#   verified - Equivalence tested against Python
#
# GOAL: 100% parity (331/331 capabilities)

metadata:
  python_project: garak
  python_version: "0.13.4"
  python_repo: https://github.com/NVIDIA/garak
  go_module: github.com/praetorian-inc/augustus
  go_version: "1.25.3"
  last_updated: "2025-12-29"

# Summary (auto-calculated from items below)
parity:
  probes: 5/176
  generators: 10/43
  detectors: 4/89
  buffs: 5/6
  harnesses: 1/2
  overall: 25/331

# ============================================
# PROBES (176 total)
# ============================================
probes:
  total: 176

  # Tier 1: Trivial (no deps)
  tier1:
    - name: test.Blank
      python_path: garak/probes/test.py
      go_path: pkg/probes/test/blank.go
      status: ported
      notes: Single empty prompt

    - name: test.Test
      python_path: garak/probes/test.py
      go_path: pkg/probes/test/test.go
      status: ported
      notes: Multiple test prompts

  # Tier 2: Simple (template expansion, basic deps)
  tier2:
    - name: apikey.GetKey
      python_path: garak/probes/apikey.py
      go_path: pkg/probes/apikey/getkey.go
      status: verified
      notes: Template expansion for API key extraction, 58 prompts from DORA_REGEXES key types

  # Tier 3: Medium (API integration)
  tier3:
    - name: dan.Dan_11_0
      python_path: garak/probes/dan.py
      go_path: pkg/probes/dan/dan.go
      status: verified
      notes: DAN 11.0 jailbreak probe, single long prompt with {generator.name} placeholder

  # Tier 4: Complex (tree search, multi-turn)
  tier4:
    - name: base.TreeSearchProbe
      python_path: garak/probes/base.py
      go_path: pkg/probes/treesearch/treesearch.go
      status: tested
      notes: >
        Abstract base for iterative tree search probes. Implements BFS/DFS exploration,
        per-node/per-generation thresholds, target_soft exploration direction,
        and never-queue exclusion lists. 17 unit tests passing.

# ============================================
# GENERATORS (43 total)
# ============================================
generators:
  total: 43

  tier1:
    - name: test.Blank
      python_path: garak/generators/test.py
      go_path: pkg/generators/test/blank.go
      status: ported
      notes: Returns empty string

    - name: test.Repeat
      python_path: garak/generators/test.py
      go_path: pkg/generators/test/repeat.go
      status: ported
      notes: Echoes input

  tier2:
    - name: rest.Rest
      python_path: garak/generators/rest.py
      go_path: pkg/generators/rest/rest.go
      status: tested
      notes: Generic HTTP API with template substitution, JSON response parsing, JSONPath support

  tier3:
    - name: openai.OpenAI
      python_path: garak/generators/openai.py
      go_path: pkg/generators/openai/openai.go
      status: tested
      notes: Uses go-openai library, supports both chat and completion APIs

    - name: ollama.Ollama
      python_path: garak/generators/ollama.py
      go_path: pkg/generators/ollama/ollama.go
      status: tested
      notes: Uses HTTP API directly, supports generate endpoint for text completion

    - name: ollama.OllamaChat
      python_path: garak/generators/ollama.py
      go_path: pkg/generators/ollama/ollama.go
      status: tested
      notes: Uses HTTP API directly, supports chat endpoint for multi-turn conversations

    - name: cohere.Cohere
      python_path: garak/generators/cohere.py
      go_path: pkg/generators/cohere/cohere.go
      status: tested
      notes: Uses HTTP API directly, supports v1 generate and v2 chat APIs

    - name: anthropic.Anthropic
      python_path: garak/generators/litellm.py  # Anthropic accessed via litellm in garak
      go_path: pkg/generators/anthropic/anthropic.go
      status: tested
      notes: >
        Native Anthropic Messages API implementation. Supports Claude 3/3.5 models,
        system prompts (separate from messages), temperature, top_p, top_k, stop_sequences.
        27 unit tests passing.

    - name: replicate.Replicate
      python_path: garak/generators/replicate.py
      go_path: pkg/generators/replicate/replicate.go
      status: tested
      notes: >
        Replicate API generator for open-source LLM models. Uses official replicate-go SDK,
        supports temperature, top_p, repetition_penalty, seed. 22 unit tests passing.

    - name: huggingface.InferenceAPI
      python_path: garak/generators/huggingface.py
      go_path: pkg/generators/huggingface/inference.go
      status: tested
      notes: >
        HuggingFace Inference API generator for hosted models. Uses shared HTTP client,
        supports HF_INFERENCE_TOKEN/HUGGINGFACE_API_KEY, deprefix_prompt, max_time,
        wait_for_model, 503 retry for model loading. 23 unit tests passing.

# ============================================
# DETECTORS (89 total)
# ============================================
detectors:
  total: 89

  tier1:
    - name: always.Pass
      python_path: garak/detectors/always.py
      go_path: pkg/detectors/always/pass.go
      status: ported
      notes: Returns 0.0

    - name: always.Fail
      python_path: garak/detectors/always.py
      go_path: pkg/detectors/always/fail.go
      status: ported
      notes: Returns 1.0

  tier2:
    - name: base.StringDetector
      python_path: garak/detectors/base.py
      go_path: pkg/detectors/base/string_detector.go
      status: verified
      notes: Substring/word/startswith matching with case sensitivity

  tier3:
    - name: packagehallucination.PythonPypi
      python_path: garak/detectors/packagehallucination.py
      go_path: pkg/detectors/packagehallucination/pythonpypi.go
      status: verified
      notes: PyPI package verification via API, caches results, handles stdlib exclusion

# ============================================
# BUFFS (6 total)
# ============================================
buffs:
  total: 6
  items:
    - name: encoding.Base64
      python_path: garak/buffs/encoding.py
      go_path: pkg/buffs/encoding/base64.go
      status: tested
      notes: >
        Base64 encodes prompts with instruction prefix. Jailbreak technique that
        obfuscates prompts to bypass safety filters. 14 unit tests passing.

    - name: encoding.CharCode
      python_path: garak/buffs/encoding.py
      go_path: pkg/buffs/encoding/charcode.go
      status: tested
      notes: >
        Encodes prompts using Unicode code points. Jailbreak technique that
        obfuscates prompts using character codes (e.g., "Hi" -> "72 105").
        11 unit tests passing.

    - name: lowercase.Lowercase
      python_path: garak/buffs/lowercase.py
      go_path: pkg/buffs/lowercase/lowercase.go
      status: tested
      notes: Converts all prompt text to lowercase. 12 unit tests passing.

    - name: paraphrase.PegasusT5
      python_path: garak/buffs/paraphrase.py
      go_path: pkg/buffs/paraphrase/pegasus.go
      status: tested
      notes: >
        Paraphrasing buff using Pegasus transformer model. Generates 6 paraphrased
        variants via HuggingFace Inference API. Tests if different phrasings bypass
        safety measures. 14 unit tests passing (shared with Fast).

    - name: paraphrase.Fast
      python_path: garak/buffs/paraphrase.py
      go_path: pkg/buffs/paraphrase/fast.go
      status: tested
      notes: >
        CPU-friendly paraphrasing buff using T5 model. Generates 5 diverse paraphrased
        variants via HuggingFace Inference API with diversity beam search. 14 unit
        tests passing (shared with PegasusT5).

# ============================================
# HARNESSES (2 total)
# ============================================
harnesses:
  total: 2
  items:
    - name: probewise.Probewise
      python_path: garak/harnesses/probewise.py
      go_path: pkg/harnesses/probewise/probewise.go
      status: tested
      notes: Main orchestration harness - processes probes one at a time, runs all detectors on each attempt

# ============================================
# INFRASTRUCTURE
# ============================================
infrastructure:
  - name: attempt
    python_path: garak/attempt.py
    go_path: pkg/attempt/
    status: ported
    notes: Core data types

  - name: configurable
    python_path: garak/configurable.py
    go_path: pkg/config/
    status: pending
    notes: Configuration system

  - name: _plugins
    python_path: garak/_plugins.py
    go_path: pkg/registry/
    status: ported
    notes: Plugin registry

# ============================================
# DEPENDENCIES
# ============================================
dependencies:
  direct_equivalents:
    - python: litellm
      go: github.com/tmc/langchaingo
      status: available

    - python: openai
      go: github.com/sashabaranov/go-openai
      status: available

    - python: anthropic
      go: github.com/anthropics/anthropic-sdk-go
      status: available

  custom_needed:
    - python: avidtools
      status: pending
      notes: Port data classes

    - python: ftfy
      status: deferred
      notes: Mojibake detection, edge case
